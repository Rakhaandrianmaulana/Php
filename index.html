<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tata Surya Sinematik Interaktif 4K</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
            font-family: 'Inter', sans-serif;
            color: #fff;
        }
        canvas {
            display: block;
        }
        #info-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 12px;
            max-width: 300px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.6);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(5px);
            transition: opacity 0.5s ease;
        }
        #info-panel.hidden {
            opacity: 0;
            pointer-events: none;
        }
        h1 {
            margin: 0 0 10px 0;
            font-size: 1.5em;
            color: #ffc107;
        }
        p, ul {
            margin: 0;
            font-size: 0.9em;
            line-height: 1.5;
        }
        /* Styling untuk Modal Info Planet */
        #planet-modal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 500px;
            background: rgba(10, 10, 25, 0.85);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            padding: 25px;
            color: #f0f0f0;
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 15px;
            opacity: 0;
            transform: translate(-50%, -45%) scale(0.95);
            pointer-events: none;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }
        #planet-modal.visible {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
            pointer-events: all;
        }
        #planet-modal h2 {
            margin: 0;
            color: #87CEEB; /* Sky Blue */
            font-size: 2em;
            text-align: center;
        }
        #planet-modal p {
            font-size: 1em;
            line-height: 1.6;
            text-align: justify;
        }
        #planet-modal .facts {
            list-style: none;
            padding: 0;
            margin-top: 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            padding-top: 15px;
        }
        #planet-modal .facts li {
            margin-bottom: 8px;
        }
        #planet-modal .facts strong {
            color: #ffc107;
        }
        #close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            transition: transform 0.2s;
        }
        #close-modal:hover {
            transform: scale(1.2);
        }
    </style>
</head>
<body>
    <div id="info-panel">
        <h1>Tata Surya Sinematik 4K</h1>
        <p>Klik pada planet untuk zoom dan melihat detailnya. Gunakan mouse untuk navigasi saat tidak di-zoom:</p>
        <ul>
            <li><b>Klik & Seret:</b> Putar kamera</li>
            <li><b>Scroll:</b> Zoom in/out</li>
        </ul>
    </div>

    <!-- Modal Info Planet -->
    <div id="planet-modal">
        <button id="close-modal">&times;</button>
        <h2 id="planet-name"></h2>
        <p id="planet-description"></p>
        <ul class="facts">
            <li id="planet-diameter"></li>
            <li id="planet-distance"></li>
            <li id="planet-day"></li>
            <li id="planet-year"></li>
        </ul>
    </div>

    <canvas id="solar-system-canvas"></canvas>

    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/",
                "tween": "https://unpkg.com/@tweenjs/tween.js@23.1.1/dist/tween.esm.js"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';
        import TWEEN from 'tween';

        // --- SETUP DASAR ---
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 4000);
        const renderer = new THREE.WebGLRenderer({
            canvas: document.querySelector('#solar-system-canvas'),
            antialias: true
        });
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true; // Aktifkan bayangan
        camera.position.set(0, 100, 280);

        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.minDistance = 20;
        controls.maxDistance = 1200;

        // --- DATA EDUKASI & TEKSTUR ---
        const textureLoader = new THREE.TextureLoader();
        const textureBaseUrl = 'https://raw.githubusercontent.com/jeromeetienne/threex.planets/master/images/';
        const planetsData = { /* Data sama seperti sebelumnya */ 
            sun: { name: 'Matahari', size: 16, texture: textureBaseUrl + 'sunmap.jpg', description: 'Matahari adalah bintang di pusat Tata Surya. Ia adalah sumber energi utama bagi kehidupan di Bumi.', facts: { diameter: '1,392,684 km', temp: '5,505 Â°C (Permukaan)' } },
            mercury: { name: 'Merkurius', size: 1.8, distance: 35, speed: 0.04, texture: textureBaseUrl + 'mercurymap.jpg', bumpMap: textureBaseUrl + 'mercurybump.jpg', description: 'Merkurius adalah planet terkecil di Tata Surya sekaligus yang terdekat dari Matahari.', facts: { diameter: '4,879 km', distance: '57.9 juta km', day: '58.6 hari Bumi', year: '88 hari Bumi' } },
            venus: { name: 'Venus', size: 3.5, distance: 60, speed: 0.025, texture: textureBaseUrl + 'venusmap.jpg', bumpMap: textureBaseUrl + 'venusbump.jpg', description: 'Venus adalah planet kedua terdekat dari Matahari, dikenal sebagai "bintang fajar" dan merupakan planet terpanas.', facts: { diameter: '12,104 km', distance: '108.2 juta km', day: '243 hari Bumi', year: '224.7 hari Bumi' } },
            earth: { name: 'Bumi', size: 4, distance: 90, speed: 0.015, texture: textureBaseUrl + 'earthmap1k.jpg', bumpMap: textureBaseUrl + 'earthbump1k.jpg', specularMap: textureBaseUrl + 'earthspec1k.jpg', cloudsTexture: textureBaseUrl + 'earthcloudmap.jpg', description: 'Bumi adalah planet ketiga dari Matahari dan satu-satunya tempat yang diketahui memiliki kehidupan.', facts: { diameter: '12,742 km', distance: '149.6 juta km', day: '23.9 jam', year: '365.2 hari' }, moon: { name: 'Bulan', size: 1, distance: 8, speed: 0.05, texture: textureBaseUrl + 'moonmap1k.jpg' } },
            mars: { name: 'Mars', size: 2.5, distance: 130, speed: 0.01, texture: textureBaseUrl + 'marsmap1k.jpg', bumpMap: textureBaseUrl + 'marsbump1k.jpg', description: 'Mars dikenal sebagai "Planet Merah" karena warnanya yang kemerahan akibat debu oksida besi.', facts: { diameter: '6,779 km', distance: '227.9 juta km', day: '24.6 jam', year: '687 hari Bumi' } },
            jupiter: { name: 'Jupiter', size: 10, distance: 200, speed: 0.005, texture: textureBaseUrl + 'jupitermap.jpg', description: 'Jupiter adalah planet terbesar di Tata Surya, sebuah raksasa gas yang terkenal dengan "Bintik Merah Raksasa".', facts: { diameter: '139,820 km', distance: '778.5 juta km', day: '9.9 jam', year: '11.9 tahun Bumi' } },
            saturn: { name: 'Saturnus', size: 8, distance: 280, speed: 0.003, texture: textureBaseUrl + 'saturnmap.jpg', ringTexture: textureBaseUrl + 'saturnringcolor.jpg', description: 'Saturnus dikenal karena sistem cincinnya yang spektakuler, yang sebagian besar terdiri dari partikel es.', facts: { diameter: '116,460 km', distance: '1.43 miliar km', day: '10.7 jam', year: '29.5 tahun Bumi' } },
            uranus: { name: 'Uranus', size: 6, distance: 350, speed: 0.002, texture: textureBaseUrl + 'uranusmap.jpg', description: 'Uranus adalah raksasa es yang unik karena berotasi pada sisi miringnya.', facts: { diameter: '50,724 km', distance: '2.87 miliar km', day: '17.2 jam', year: '84 tahun Bumi' } },
            neptune: { name: 'Neptunus', size: 5.5, distance: 420, speed: 0.001, texture: textureBaseUrl + 'neptunemap.jpg', description: 'Neptunus adalah planet terjauh dari Matahari, sebuah raksasa es yang gelap, dingin, dan berangin.', facts: { diameter: '49,244 km', distance: '4.5 miliar km', day: '16.1 jam', year: '164.8 tahun Bumi' } }
        };

        // --- MEMBUAT OBJEK TATA SURYA ---
        const solarSystemObjects = new THREE.Group();
        scene.add(solarSystemObjects);
        const clickableObjects = [];

        // Matahari
        const sunData = planetsData.sun;
        const sun = new THREE.Mesh(
            new THREE.SphereGeometry(sunData.size, 64, 64),
            new THREE.MeshBasicMaterial({ map: textureLoader.load(sunData.texture) })
        );
        sun.userData = { id: 'sun', ...sunData };
        solarSystemObjects.add(sun);
        clickableObjects.push(sun);

        // Planet-planet
        Object.keys(planetsData).filter(key => key !== 'sun').forEach(key => {
            const p = planetsData[key];
            const planetGroup = new THREE.Group();
            
            const material = new THREE.MeshStandardMaterial({
                map: textureLoader.load(p.texture),
                bumpMap: p.bumpMap ? textureLoader.load(p.bumpMap) : null, bumpScale: 0.05,
                metalness: 0.1, roughness: 0.7,
                // PENINGKATAN: Emissive agar planet terlihat di kegelapan
                emissive: 0x111111 
            });
            const mesh = new THREE.Mesh(new THREE.SphereGeometry(p.size, 32, 32), material);
            mesh.userData = { id: key, ...p };
            mesh.castShadow = true;
            mesh.receiveShadow = true;
            planetGroup.add(mesh);
            clickableObjects.push(mesh);
            
            if (p.cloudsTexture) { /* ... logika awan ... */ 
                const cloudsMesh = new THREE.Mesh(
                    new THREE.SphereGeometry(p.size + 0.05, 32, 32),
                    new THREE.MeshPhongMaterial({ map: textureLoader.load(p.cloudsTexture), transparent: true, opacity: 0.6 })
                );
                planetGroup.add(cloudsMesh);
                p.clouds = cloudsMesh;
            }
            if (p.moon) { /* ... logika bulan ... */ 
                 const moonData = p.moon;
                const moonMesh = new THREE.Mesh(
                    new THREE.SphereGeometry(moonData.size, 16, 16),
                    new THREE.MeshStandardMaterial({ map: textureLoader.load(moonData.texture), emissive: 0x111111 })
                );
                planetGroup.add(moonMesh);
                p.moon = moonMesh;
            }
            if (p.ringTexture) { /* ... logika cincin ... */
                const ringMesh = new THREE.Mesh(
                    new THREE.RingGeometry(p.size + 2, p.size + 8, 64),
                    new THREE.MeshBasicMaterial({ map: textureLoader.load(p.ringTexture), side: THREE.DoubleSide, transparent: true, opacity: 0.9 })
                );
                ringMesh.rotation.x = -0.5 * Math.PI;
                ringMesh.receiveShadow = true;
                planetGroup.add(ringMesh);
            }

            const orbit = new THREE.Line(
                new THREE.BufferGeometry().setFromPoints(new THREE.Path().absellipse(0, 0, p.distance, p.distance, 0, Math.PI * 2, false).getSpacedPoints(128)),
                new THREE.LineBasicMaterial({ color: 0xffffff, transparent: true, opacity: 0.15 })
            );
            orbit.rotation.x = Math.PI / 2;
            solarSystemObjects.add(orbit);

            p.group = planetGroup;
            p.angle = Math.random() * Math.PI * 2;
            solarSystemObjects.add(planetGroup);
        });

        // --- PENCAHAYAAN & EFEK ---
        const sunLight = new THREE.PointLight(0xffffff, 4, 3000);
        sunLight.castShadow = true; // Matahari menghasilkan bayangan
        scene.add(sunLight);
        scene.add(new THREE.AmbientLight(0x404040, 0.5)); // Cahaya ambient lebih terang
        // PENINGKATAN: Hemisphere light untuk mengisi sisi gelap
        scene.add(new THREE.HemisphereLight(0x606060, 0x101010, 0.3));

        const composer = new EffectComposer(renderer);
        composer.addPass(new RenderPass(scene, camera));
        const bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85);
        bloomPass.threshold = 0; bloomPass.strength = 2.2; bloomPass.radius = 0.6;
        composer.addPass(bloomPass);

        // --- LATAR BELAKANG BINTANG ---
        const stars = new THREE.Points(new THREE.BufferGeometry().setAttribute('position', new THREE.Float32BufferAttribute(Array.from({ length: 25000 * 3 }, () => THREE.MathUtils.randFloatSpread(3000)), 3)), new THREE.PointsMaterial({ color: 0xffffff, size: 0.6 }));
        scene.add(stars);

        // --- INTERAKSI & ANIMASI ZOOM ---
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();
        const modal = document.getElementById('planet-modal');
        let previousCameraState = {};

        function animateCameraToObject(targetObject) {
            const targetData = targetObject.userData;
            const targetPosition = new THREE.Vector3();
            targetObject.getWorldPosition(targetPosition);
            
            // Simpan state sebelum zoom
            previousCameraState = {
                pos: camera.position.clone(),
                target: controls.target.clone()
            };
            
            // Hitung posisi kamera baru
            const cameraOffset = new THREE.Vector3(0, targetData.size * 0.5, targetData.size * 3.5);
            const cameraTargetPosition = targetPosition.clone().add(cameraOffset);
            
            controls.enabled = false;
            document.getElementById('info-panel').classList.add('hidden');

            // Animasi zoom dengan TWEEN
            new TWEEN.Tween(camera.position)
                .to(cameraTargetPosition, 1500)
                .easing(TWEEN.Easing.Quadratic.InOut)
                .start();

            new TWEEN.Tween(controls.target)
                .to(targetPosition, 1500)
                .easing(TWEEN.Easing.Quadratic.InOut)
                .onComplete(() => showPlanetInfo(targetData))
                .start();
        }

        function returnCamera() {
            controls.enabled = false;
            modal.classList.remove('visible');
            
            new TWEEN.Tween(camera.position)
                .to(previousCameraState.pos, 1500)
                .easing(TWEEN.Easing.Quadratic.InOut)
                .start();
                
            new TWEEN.Tween(controls.target)
                .to(previousCameraState.target, 1500)
                .easing(TWEEN.Easing.Quadratic.InOut)
                .onComplete(() => {
                    controls.enabled = true;
                    document.getElementById('info-panel').classList.remove('hidden');
                })
                .start();
        }

        function showPlanetInfo(data) {
            // Isi data ke modal
            document.getElementById('planet-name').textContent = data.name;
            document.getElementById('planet-description').textContent = data.description;
            const facts = ['diameter', 'distance', 'day', 'year'];
            facts.forEach(fact => {
                const el = document.getElementById(`planet-${fact}`);
                el.style.display = 'none';
            });
            if (data.id === 'sun') {
                document.getElementById('planet-diameter').innerHTML = `<strong>Diameter:</strong> ${data.facts.diameter}`;
                document.getElementById('planet-distance').innerHTML = `<strong>Suhu Permukaan:</strong> ${data.facts.temp}`;
                document.getElementById('planet-diameter').style.display = 'list-item';
                document.getElementById('planet-distance').style.display = 'list-item';
            } else {
                document.getElementById('planet-diameter').innerHTML = `<strong>Diameter:</strong> ${data.facts.diameter}`;
                document.getElementById('planet-distance').innerHTML = `<strong>Jarak dari Matahari:</strong> ${data.facts.distance}`;
                document.getElementById('planet-day').innerHTML = `<strong>Lama Sehari (Rotasi):</strong> ${data.facts.day}`;
                document.getElementById('planet-year').innerHTML = `<strong>Lama Setahun (Revolusi):</strong> ${data.facts.year}`;
                facts.forEach(fact => document.getElementById(`planet-${fact}`).style.display = 'list-item');
            }
            modal.classList.add('visible');
        }

        document.getElementById('close-modal').addEventListener('click', returnCamera);
        window.addEventListener('click', (event) => {
            if (!controls.enabled) return; // Jangan lakukan apa-apa saat animasi
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(clickableObjects);
            if (intersects.length > 0) {
                animateCameraToObject(intersects[0].object);
            }
        });

        // --- LOOP ANIMASI UTAMA ---
        const clock = new THREE.Clock();
        function animate() {
            requestAnimationFrame(animate);
            const elapsedTime = clock.getElapsedTime();
            
            TWEEN.update(); // Update animasi TWEEN
            
            Object.values(planetsData).forEach(p => {
                if(p.group) {
                    p.group.position.x = Math.cos(elapsedTime * p.speed + p.angle) * p.distance;
                    p.group.position.z = Math.sin(elapsedTime * p.speed + p.angle) * p.distance;
                    p.group.children[0].rotation.y += 0.005;
                    if(p.clouds) p.clouds.rotation.y += 0.003;
                    if(p.moon) {
                        const moonData = planetsData.earth.moon;
                        p.moon.position.x = Math.cos(elapsedTime * moonData.speed * 5) * moonData.distance;
                        p.moon.position.z = Math.sin(elapsedTime * moonData.speed * 5) * moonData.distance;
                    }
                }
            });
            sun.rotation.y += 0.0005;

            controls.update();
            composer.render();
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            composer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
    </script>
</body>
</html>
